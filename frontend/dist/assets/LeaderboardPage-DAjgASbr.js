import{r as n,j as s,m as h,n as L,o as A,p as k,q as R}from"./react-vendor-CTCOu_cH.js";import{c as F,d as P,e as T}from"./index-DWD9sWeV.js";import{P as S}from"./PageLayout-BcvhvPkp.js";import"./vendor-62T33e3N.js";import"./lottie-vendor-CdbPF2lo.js";import"./date-vendor-BIBOd_sa.js";import"./chart-vendor-CqyaVfOQ.js";import"./axios-vendor-D5lHaTRS.js";const $="_tabsContainer_1isj8_14",w="_tab_1isj8_14",z="_tabCollapsed_1isj8_39",D="_tabActive_1isj8_46",E="_tabIcon_1isj8_55",M="_tabLabel_1isj8_60",V="_myRankCard_1isj8_81",q="_podium_1isj8_95",B="_podiumItem_1isj8_103",G="_podiumAvatar_1isj8_104",X="_podiumName_1isj8_108",H="_podiumPoints_1isj8_109",J="_place2_1isj8_110",K="_place1_1isj8_111",O="_place3_1isj8_112",Q="_podiumIcon_1isj8_116",U="_list_1isj8_119",W="_listItem_1isj8_123",Y="_listItemAvatar_1isj8_139",Z="_rank_1isj8_147",ss="_userInfo_1isj8_153",as="_userName_1isj8_156",es="_pointsContainer_1isj8_162",ts="_points_1isj8_162",is="_pointsLogo_1isj8_175",a={tabsContainer:$,tab:w,tabCollapsed:z,tabActive:D,tabIcon:E,tabLabel:M,myRankCard:V,podium:q,podiumItem:B,podiumAvatar:G,podiumName:X,podiumPoints:H,place2:J,place1:K,place3:O,podiumIcon:Q,list:U,listItem:W,listItemAvatar:Y,rank:Z,userInfo:ss,userName:as,pointsContainer:es,points:ts,pointsLogo:is},r=[{id:"all_time_received",label:"За всё время",icon:s.jsx(L,{}),params:{period:"all_time",type:"received"}},{id:"current_month_received",label:"Этот месяц",icon:s.jsx(A,{}),params:{period:"current_month",type:"received"}},{id:"last_month_received",label:"Прошлый месяц",icon:s.jsx(k,{}),params:{period:"last_month",type:"received"}},{id:"generosity",label:"Щедрость",icon:s.jsx(R,{}),params:{period:"current_month",type:"sent"}}];function _s({user:m}){const[c,b]=n.useState(r[0].id),[l,v]=n.useState(m.is_admin?r:[]),[p,N]=n.useState([]),[_,I]=n.useState(null),[y,d]=n.useState(!0);n.useEffect(()=>{if(m.is_admin)return;(async()=>{try{const i=await T(),o=r.filter(j=>{const g=i.data.find(C=>C.id===j.id);return g&&g.has_data});v(o);const u=o.some(j=>j.id===r[0].id);o.length>0&&!u?b(o[0].id):o.length===0&&d(!1)}catch{d(!1)}})()},[m.is_admin]);const x=n.useCallback(async()=>{d(!0);try{const e=r.find(u=>u.id===c);if(!e){d(!1);return}const[i,o]=await Promise.all([F(e.params),P(e.params)]);N(i.data),I(o.data)}catch{}finally{d(!1)}},[c]);n.useEffect(()=>{const e=r.find(i=>i.id===c);l.includes(e)&&x()},[x,l,c]);const t=p.slice(0,3),f=p.slice(3);return s.jsxs(S,{title:"Рейтинг",children:[l.length>0&&s.jsx("div",{className:a.tabsContainer,children:l.map(e=>s.jsxs("button",{onClick:()=>b(e.id),className:`${a.tab} ${c===e.id?a.tabActive:a.tabCollapsed}`,children:[s.jsx("span",{className:a.tabIcon,children:e.icon}),s.jsx("span",{className:a.tabLabel,children:e.label})]},e.id))}),y?s.jsx("p",{children:"Загрузка рейтинга..."}):s.jsxs(s.Fragment,{children:[_&&_.rank!==null&&s.jsx("div",{className:a.myRankCard,children:s.jsxs("p",{children:["Вы на ",s.jsxs("strong",{children:[_.rank,"-м"]})," месте"]})}),t.length>0&&s.jsxs("div",{className:a.podium,children:[t[1]&&s.jsxs("div",{className:`${a.podiumItem} ${a.place2}`,children:[s.jsx(h,{className:a.podiumIcon,color:"#C0C0C0"}),s.jsx("img",{src:t[1].user.telegram_photo_url||"placeholder.png",alt:t[1].user.first_name,className:a.podiumAvatar,loading:"lazy"}),s.jsx("div",{className:a.podiumName,children:t[1].user.first_name}),s.jsx("div",{className:a.podiumPoints,children:t[1].total_received})]}),t[0]&&s.jsxs("div",{className:`${a.podiumItem} ${a.place1}`,children:[s.jsx(h,{className:a.podiumIcon,color:"#FFD700"}),s.jsx("img",{src:t[0].user.telegram_photo_url||"placeholder.png",alt:t[0].user.first_name,className:a.podiumAvatar,loading:"lazy"}),s.jsx("div",{className:a.podiumName,children:t[0].user.first_name}),s.jsx("div",{className:a.podiumPoints,children:t[0].total_received})]}),t[2]&&s.jsxs("div",{className:`${a.podiumItem} ${a.place3}`,children:[s.jsx(h,{className:a.podiumIcon,color:"#CD7F32"}),s.jsx("img",{src:t[2].user.telegram_photo_url||"placeholder.png",alt:t[2].user.first_name,className:a.podiumAvatar,loading:"lazy"}),s.jsx("div",{className:a.podiumName,children:t[2].user.first_name}),s.jsx("div",{className:a.podiumPoints,children:t[2].total_received})]})]}),f.length>0&&s.jsx("ol",{start:"4",className:a.list,children:f.map((e,i)=>s.jsxs("li",{className:a.listItem,children:[s.jsx("span",{className:a.rank,children:i+4}),s.jsx("img",{src:e.user.telegram_photo_url||"placeholder.png",alt:e.user.first_name,className:a.listItemAvatar,loading:"lazy"}),s.jsx("div",{className:a.userInfo,children:s.jsx("span",{className:a.userName,children:e.user.first_name})}),s.jsxs("div",{className:a.pointsContainer,children:[s.jsx("span",{className:a.points,children:e.total_received}),s.jsx("img",{src:"https://i.postimg.cc/cLCwXyrL/Frame-2131328056.webp",alt:"спасибо",className:a.pointsLogo,loading:"lazy"})]})]},e.user.id))}),p.length===0&&l.length>0&&s.jsx("p",{children:"В этом рейтинге пока нет данных."}),l.length===0&&!m.is_admin&&s.jsx("p",{children:"Рейтинги пока пусты. Скоро здесь появится активность!"})]})]})}export{_s as default};
