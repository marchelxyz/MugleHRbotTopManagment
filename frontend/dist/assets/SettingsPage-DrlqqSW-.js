import{r as l,j as s,Z as M,_ as S,$ as v,a0 as F,a1 as L,a2 as D,k as x,l as h}from"./react-vendor-CTCOu_cH.js";import{P as A}from"./PageLayout-BcvhvPkp.js";import{u as q,f as E,aa as O}from"./index-DWD9sWeV.js";import"./vendor-62T33e3N.js";import"./lottie-vendor-CdbPF2lo.js";import"./date-vendor-BIBOd_sa.js";import"./chart-vendor-CqyaVfOQ.js";import"./axios-vendor-D5lHaTRS.js";const Q="_backButton_o9x2e_3",W="_settingsList_o9x2e_6",H="_settingsItem_o9x2e_13",R="_settingsItemDisabled_o9x2e_14",T="_icon_o9x2e_50",U="_passwordModal_o9x2e_71",Z="_passwordModalContent_o9x2e_85",$="_passwordInputContainer_o9x2e_101",z="_input_o9x2e_107",G="_eyeButton_o9x2e_123",J="_passwordModalButtons_o9x2e_144",K="_submitButton_o9x2e_151",V="_cancelButton_o9x2e_175",t={backButton:Q,settingsList:W,settingsItem:H,settingsItemDisabled:R,icon:T,passwordModal:U,passwordModalContent:Z,passwordInputContainer:$,input:z,eyeButton:G,passwordModalButtons:J,submitButton:K,cancelButton:V};var _;const X=!((_=window.Telegram)!=null&&_.WebApp);function cs({onBack:g,onNavigate:P,onRepeatOnboarding:b,user:r}){const{showAlert:a}=q(),{confirm:C}=E(),[N,d]=l.useState(!1),[n,u]=l.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[o,m]=l.useState({current:!1,new:!1,confirm:!1}),[j,f]=l.useState(!1),B="https://t.me/fix2Form",y=async()=>{await C("Выход из аккаунта","Вы уверены, что хотите выйти из аккаунта?")&&(localStorage.removeItem("userId"),localStorage.removeItem("user"),window.location.reload())},w=e=>{const{name:c,value:i}=e.target;u(p=>({...p,[c]:i}))},I=async e=>{var c,i;if(e.preventDefault(),!n.currentPassword||!n.newPassword||!n.confirmPassword){a("Пожалуйста, заполните все поля","error");return}if(n.newPassword!==n.confirmPassword){a("Новый пароль и подтверждение не совпадают","error");return}if(n.newPassword.length<6){a("Пароль должен содержать минимум 6 символов","error");return}f(!0);try{await O(n.currentPassword,n.newPassword),a("Пароль успешно изменен","success"),u({currentPassword:"",newPassword:"",confirmPassword:""}),d(!1)}catch(p){const k=((i=(c=p.response)==null?void 0:c.data)==null?void 0:i.detail)||"Не удалось изменить пароль";a(k,"error")}finally{f(!1)}};return s.jsxs(A,{title:"Настройки",children:[s.jsx("button",{onClick:g,className:t.backButton,children:"← Назад в профиль"}),s.jsxs("div",{className:t.settingsList,children:[s.jsxs("button",{onClick:b,className:t.settingsItem,children:[s.jsx(M,{className:t.icon}),s.jsx("span",{children:"Пройти обучение повторно"})]}),s.jsxs("button",{onClick:()=>P("faq"),className:t.settingsItem,children:[s.jsx(S,{className:t.icon}),s.jsx("span",{children:"Часто задаваемые вопросы (FAQ)"})]}),s.jsxs("a",{href:B,target:"_blank",rel:"noopener noreferrer",className:t.settingsItem,children:[s.jsx(v,{className:t.icon}),s.jsx("span",{children:"Поддержка"})]}),r&&r.login&&s.jsxs("button",{onClick:()=>d(!0),className:t.settingsItem,children:[s.jsx(F,{className:t.icon}),s.jsx("span",{children:"Изменить пароль"})]}),(X||r&&r.login)&&s.jsxs("button",{onClick:y,className:t.settingsItem,children:[s.jsx(L,{className:t.icon}),s.jsx("span",{children:"Выйти из аккаунта"})]}),s.jsxs("div",{className:t.settingsItemDisabled,children:[s.jsx(D,{className:t.icon}),s.jsx("span",{children:"Юридическая документация"})]})]}),N&&s.jsx("div",{className:t.passwordModal,children:s.jsxs("div",{className:t.passwordModalContent,children:[s.jsx("h2",{children:"Изменение пароля"}),s.jsxs("form",{onSubmit:I,children:[s.jsxs("div",{className:t.passwordInputContainer,children:[s.jsx("input",{name:"currentPassword",type:o.current?"text":"password",value:n.currentPassword,onChange:w,placeholder:"Текущий пароль",className:t.input,required:!0}),s.jsx("button",{type:"button",className:t.eyeButton,onClick:()=>m(e=>({...e,current:!e.current})),children:o.current?s.jsx(x,{}):s.jsx(h,{})})]}),s.jsxs("div",{className:t.passwordInputContainer,children:[s.jsx("input",{name:"newPassword",type:o.new?"text":"password",value:n.newPassword,onChange:w,placeholder:"Новый пароль",className:t.input,required:!0}),s.jsx("button",{type:"button",className:t.eyeButton,onClick:()=>m(e=>({...e,new:!e.new})),children:o.new?s.jsx(x,{}):s.jsx(h,{})})]}),s.jsxs("div",{className:t.passwordInputContainer,children:[s.jsx("input",{name:"confirmPassword",type:o.confirm?"text":"password",value:n.confirmPassword,onChange:w,placeholder:"Подтвердите новый пароль",className:t.input,required:!0}),s.jsx("button",{type:"button",className:t.eyeButton,onClick:()=>m(e=>({...e,confirm:!e.confirm})),children:o.confirm?s.jsx(x,{}):s.jsx(h,{})})]}),s.jsxs("div",{className:t.passwordModalButtons,children:[s.jsx("button",{type:"submit",disabled:j,className:t.submitButton,children:j?"Изменение...":"Изменить пароль"}),s.jsx("button",{type:"button",onClick:()=>{d(!1),u({currentPassword:"",newPassword:"",confirmPassword:""})},className:t.cancelButton,children:"Отмена"})]})]})]})})]})}export{cs as default};
